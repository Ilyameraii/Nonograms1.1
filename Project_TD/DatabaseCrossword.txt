CREATE DATABASE JapaneseCrossword;
USE JapaneseCrossword;
CREATE TABLE Crossword (
    CrosswordID INT IDENTITY(1,1) PRIMARY KEY,
    Name NVARCHAR(255) NOT NULL,
	Matrix NVARCHAR(255) NOT NULL,
    Width INT NOT NULL,
    Height INT NOT NULL,
	Difficult INT NOT NULL,
);
CREATE TABLE Users (
	UsersID INT IDENTITY(1,1) PRIMARY KEY,
	UserLogin NVARCHAR(255) NOT NULL UNIQUE,
	UserPassword CHAR(255) NOT NULL,
	UserEmail NVARCHAR(255) NOT NULL,
	RegistrationDate DATE DEFAULT GETDATE(),
)
CREATE TABLE SolvingProcess (
    SolvingProcessID INT IDENTITY(1,1) PRIMARY KEY,
    UsersID INT,
    CrosswordID INT,
    StatusOfCrossword BIT DEFAULT 0, -- 0 - не решен, 1 - решен
    Progress NVARCHAR(255) NOT NULL, 
    StartTime DATETIME2 DEFAULT GETDATE(), -- Время начала решения
    EndTime DATETIME2 NULL, -- Время завершения решения
    HintsUsed INT DEFAULT 0, -- Количество использованных подсказок (новое поле)
    FOREIGN KEY (UsersID) REFERENCES Users(UsersID),
    FOREIGN KEY (CrosswordID) REFERENCES Crossword(CrosswordID)
);
CREATE TABLE UserResult (
    UserResultID INT IDENTITY(1,1) PRIMARY KEY,
    UsersID INT,
    CrosswordID INT,
    LeadTime INT, -- Время выполнения (в секундах)
    Mistakes INT, -- Количество ошибок
    SaveDate DATE,
    FOREIGN KEY (UsersID) REFERENCES Users(UsersID),
    FOREIGN KEY (CrosswordID) REFERENCES Crossword(CrosswordID)
);
DROP TABLE Crossword;
DROP TABLE Users;
DROP TABLE SolvingProcess;
DROP TABLE UserResult;
SELECT* FROM Crossword;
SELECT* FROM Users;
SELECT* FROM SolvingProcess;
SELECT*FROM UserResult;